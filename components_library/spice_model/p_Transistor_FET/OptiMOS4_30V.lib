* ------------------------------------------------------------------------------
* 
* DISCLAIMER
* 
* INFINEON'S MODEL TERMS OF USE
* 
* BY DOWNLOADING AND/OR USING THIS INFINEON MODEL ("MODEL"), THE USER
* (INCLUDING YOU) AGREES TO BE BOUND BY THE TERMS OF USE HERE STATED. IF USER
* DOES NOT AGREE TO ALL TERMS OF USE HERE STATED, USER SHALL NOT DOWNLOAD,
* USE OR COPY THE MODEL BUT IMMEDIATELY DELETE IT (TO THE EXTENT THAT IT
* WAS DOWNLOADED ALREADY).
* 
* 1. SCOPE OF USE
* 1.1 Any use of this Model provided by Infineon Technologies AG is subject
*     to these Terms of Use.
* 1.2 This Model, provided by Infineon, does not fully represent all of the
*     specifications and operating characteristics of the product to which
*     this Model relates.
* 1.3 This Model only describes the characteristics of a typical product.
*     In all cases, the current data sheet information for a given product
*     is the final design guideline and the only actual performance
*     specification. Although this Model can be a useful tool to evaluate
*     the product performance, it cannot simulate the exact product performance
*     under all conditions and it is also not intended to replace
*     bread-boarding for final verification.
* 
* 2. IMPORTANT NOTICE
* 2.1 Infineon Technologies AG ("Infineon") is not and cannot be aware of the
*     specific application of the Infineon's Model by User. However, Model may
*     from time to time be used by User in potentially harmful and/or life-
*     endangering applications such as traffic, logistic, medical, nuclear
*     or military applications or in other applications where failure of the
*     Model may predictably cause damage to persons' life or health or to
*     property (hereinafter "Critical Applications").
* 2.2 User acknowledges that Infineon has not specifically designed or
*     qualified the Model for Critical Applications that the Model may contain
*     errors and bugs and that User is required to qualify the Model for
*     Critical Applications pursuant to the applicable local quality, safety
*     and legal requirements before permitting or giving access to any such use.
* 
* 3. CONFIDENTIAL INFORMATION
*     User shall treat ideas, concepts and information incorporated in the
*     Model, the documentation and the content of this Terms of Use (together
*     hereinafter "Confidential Information") confidential, not disclose it to
*     any third party unless otherwise agreed in writing between User and
*     Infineon, not use it for any other purposes than using the Model for
*     simulation and testing purposes only.
* 
* 4. WARRANTY
* 4.1 User acknowledges that the Model is provided by Infineon under this Terms
*     of Use is provided free of charge and "AS IS" without any warranty or
*     liability of any kind and Infineon hereby expressly disclaims any
*     warranties or representations, whether express, implied, statutory or
*     otherwise, including but not limited to warranties of workmanship,
*     merchantability, fitness for a particular purpose, defects in the
*     Model, or non-infringement of third parties intellectual property rights.
* 4.2 Infineon reserves the right to make corrections, deletions, modifications,
*     enhancements, improvements and other changes to the Model at any time
*     or to move or discontinue any Model without notice.
* 
* 5. LIABILITY
* 5.1 Nothing in this Terms of Use shall limit or exclude Infineon's liability
*     under mandatory liability laws, for injuries to life, body or health,
*     for fraudulent concealment of defects in the software, or in cases
*     of Infineon's intentional misconduct or gross negligence.
* 5.2 Without prejudice to Sections 5.1, in cases of Infineon's slight
*     negligent breach of obligations that restrict essential rights or duties
*     arising from the nature of this Terms of Use in a way that there is a
*     risk of non-achievement of the purpose of this Terms of Use or of an
*     obligation whose observance User regularly may trust in and whereas
*     compliance with only makes proper execution of this Terms of Use
*     possible, Infineon's liability shall be limited to the typically,
*     foreseeable damage.
* 5.3 Without prejudice to Sections 8.1 and 8.2, Infineon's liability under
*     this Agreement shall be excluded in all other cases.
* 
* 6. EXPORT REGULATIONS
*     The User shall comply with all applicable national and international
*     laws and regulations, in particular the applicable export control
*     regulations and sanction programs. The User also agrees not to
*     export, re-export or transfer any software or technology developed
*     with or using information, software or technology offered by Infineon,
*     in violation of any applicable laws or regulations of the competent
*     authorities. Further, the User shall neither use any products,
*     information, software and technology offered by Infineon in or in
*     connection with nuclear technology or weapons of mass destruction
*     (nuclear, biological or chemical) and carriers thereof nor supply
*     military consignees.
* 
* 7. TERMINATION OF USE PERMIT
*     If the User violates these Terms of Use, such User's permit to use
*     this Model terminates automatically. In addition, Infineon may
*     terminate the User's permit to use this Model at its discretion and
*     at any time regardless of any violation of these Terms of Use. In
*     any of the foregoing events, the User is obliged to immediately destroy
*     any content that has been downloaded or printed from Infineon's website.
* 
* 8. MISCELLANEOUS
* 8.1 These Terms of Use are subject to the laws of the Federal Republic
*     of Germany with the exception of the United Nations on Purchase
*     Contracts on the International Sale of Goods dated April 11, 1980 (CISG).
*     The exclusive place of jurisdiction is Munich, Germany.
* 8.2 Should any provision in these Terms of Use be or become invalid, the
*     validity of all other provisions or agreements shall remain unaffected
*     thereby.
* 
* ------------------------------------------------------------------------------
* 
* Title:    INFINEON Power Transistors Simulation Models for PSpice
* Description: n-channel Transistors
*                 OptiMOS4 (OptiMOS-T2) 30V
* Authors:  Dr. Elmar Gondro, Tel: +49/89/234-29391
*           Günther Moyses,   Tel: +49/89/234-24811
*           Gerhard Nöbauer,  Tel: +43/(5)/1777-6653
* Email:    Elmar.Gondro@Infineon.com
*           Guenther.Moyses@Infineon.com
*           Gerhard.Noebauer@Infineon.com
* Support:  Simulate@Infineon.com
*
* ------------------------------------------------------------------------------
* 
* This library contains models of the following INFINEON transistors:
* 
*   LL
*    IPB180N03S4L-H0    IPB180N03S4L-01    IPD90N03S4L-02     
*    IPB80N03S4L-02     IPD70N03S4L-04     IPB80N03S4L-03     
*    IPD90N03S4L-03     IPD40N03S4L-08     IPB20N03S4L-15     
*    IPD30N03S4L-14     IPD50N03S4L-06     IPD30N03S4L-09     
*    IPD135N03L         
* 
* ------------------------------------------------------------------------------
* 
* Thermal nodes of level 3 models: 
* 
*  Tj:    Potential (temperature in °C) at junction (typically not connected) 
*  Tcase: Node where boundary condition (external heat sinks) must be connected.
*         Ideal heat sink can be modeled by using a voltage source stating the 
*         ambient temperature in °C between Tcase and ground. 
* 
* ------------------------------------------------------------------------------
* 
* This file also contains simplified models that are compatible to standard 
* Spice (Level 0) 
* 
* ------------------------------------------------------------------------------
* 
* History: 
* DD/MM/YY 
* 27/07/10 models added                                                (Nöbauer)
* 11/01/13 models ITD50N04S4L-04 and ITD50N04S4L-07 added       (Gondro ,Moyses)
* 17/01/13 model IPLU300N04S4-R7 and S4_40_kd_var[1] added      (Gondro, Moyses)
* 04/02/13 model IIPC25S4N04 based on IPB180N04S4-00 added      (Gondro, Moyses)
* 07/03/13 model IIPC31S4N04 added                              (Gondro, Moyses)
* 22/08/13 new NL models for:                                   (Gondro, Moyses)
*            IPB240N04S4-R9
*            IPB240N04S4-1R0
* 05/12/13 split of OptiMOS-T2_30V_40V.lib acc. to voltage class        (Gondro)
* 11/12/13 changed "-" to "_" in subcircuit names                       (Gondro)
* 20/12/13 changed I(Ls) to I(Gs) (in case Ls=0)                        (Gondro)
* 09/05/14 model IPD50N03S4L-06 added (copy from IPD060N03L)    (Gondro, Moyses)
* 30/10/15 model IPD30N03S4L-09 added (copy from IPB009N03L)    (Gondro, Moyses)
* 17/05/17 rename Zthtype -> dZth                               (Gondro, Moyses)
* 14/07/17 PMM products removed                                         (Gondro)
* 03/05/18 param Rlim limited to avoid negative sqrt                    (Gondro)
* 
* ------------------------------------------------------------------------------
* 
* S4_30_h_var: SFET4-30V LL
* S4_30_m_var: SFET4-30V ELL
* 
* ------------------------------------------------------------------------------


********************************************************************************
* Technology Models
********************************************************************************

.SUBCKT S4_30_h_var dd g s0 Tj PARAMS: a=1 dVth=0 dR=0 dgfs=0 Inn=1 Unn=1 Rmax=1
+ gmin=1 Rs=1 Rp=1 dC=0 Rm=1u

.PARAM  Fm=0.2       Fn=0.5
.PARAM  c=1.21       Vth0=2.73   auth=2.35m
.PARAM  UT=100m      ab=20m      lB=-23       UB=39.4

.PARAM  b0=123       p0=7.71     p1=-33m      p2=54u

.PARAM  Rd=6.36m     nmu=3.21    Tref=298     T0=273       lnIsj=-25.6
.PARAM  ndi=1.1      Rdi=2.19m   nmu2=0.55    ta=3n        td=20n
.PARAM  Rf=0.722     nmu3=1.38

.PARAM  f1=210p      f2=680p     f3=870p      U0=12       nc=2    nd=1.3
.PARAM  g1=0.15      bb=1        remp=0.01p   f2r=400p
.PARAM  kbq=85.8u

.PARAM  Vmin=2.33     Vmax=3.13    dCmax=0.33
.PARAM  Vth={Vth0+(Vmax-Vth0)*limit(dVth,0,1)-(Vmin-Vth0)*limit(dVth,-1,0)}
.PARAM  q0={b0*((T0/Tref)**nmu3)*a}
.PARAM  q1={(Unn-Inn*Rs-Vth0)*q0}
.PARAM  q2={(Fm*sqrt(0.4)-c)*Inn*q0}
.PARAM  Rlim={(q1+2*q2*Rmax-sqrt(max(q1**2+4*q2,0)))/(2*q2)}
.PARAM  dRd={Rd/a+if(dVth==0,limit(dR,0,1)*max(Rlim-Rd/a-Rs-Rp,0),0)}
.PARAM  bm={c/((1/gmin-Rs)**2*Inn*a*(T0/Tref)**nmu3)}
.PARAM  bet={b0+(b0-bm)*if(dR==0,if(dVth==0,limit(dgfs,-1,0),0),0)}
.PARAM  dC1={1+dCmax*limit(dC,0,1)}
.PARAM  dC2={1+1.5*dCmax*limit(dC,0,1)}

.PARAM  Cox={f1*a*dC2}
.PARAM  Cox1={remp*sqrt(a)*dC2}
.PARAM  Cds0={(f2*a+f2r*sqrt(a))*dC1}
.PARAM  Cgs0={f3*a*dC1}
.PARAM  dRdi={Rdi/a}

.FUNC  I0(Uee,p,pp,z1)  {if(Uee>pp,(Uee-c*z1)*z1,p*(pp-p)/c*exp((Uee-pp)/p))}
.FUNC  Ig(Uds,T,p,Uee)  {bet*(T0/T)**nmu3*I0(Uee,p,min(2*p,p+c*Uds),min(Uds,Uee/(2*c)))}
.FUNC J(d,g,T,da,s) 
+ {a*(s*(Ig(da,T,(p0+(p1+p2*T)*T)*kbq*T,g-Vth+auth*(T-Tref)+Fm*da**Fn+1*limit(-d,0,1))+
+ exp(min(lB+(da-UB-ab*(T-Tref))/UT,25))))}

.FUNC  Idiode(Usd,Tj,Iss) {exp(min(log(Iss)+Usd/(ndi*kbq*Tj),7))-Iss}
.FUNC  Idiod(Usd,Tj)      {a*Idiode(Usd,Tj,exp(min(lnIsj+(Tj/Tref-1)*1.12/(ndi*kbq*Tj),7))*(Tj/Tref)**3)}

E_Edg     d   ox  VALUE {max(V(d,g),-bb)-(1/(g1*(1-nc))*((1/(1+g1*max(V(d,g)+(bb),0)))**(nc-1)-(1/(1+g1*bb))**(nc-1)))}
C_Cdg    ox    g  {Cox}
Vx        d   ox1 0
C_Cdg1   ox1   g  {Cox1}

E_Eds     d edep  VALUE {(V(d,s)-I(V_sense3)/Cds0)}
C_Cds  edep    s  {Cds0}

C_Cgs   g    s   {Cgs0}

G_chan    d    s VALUE={J(V(d,s),V(g,s),T0+limit(V(Tj),-200,300),abs(V(d,s)),sgn(V(d,s)))}
G_RMos   d1    d  VALUE={V(d1,d)/(Rf*dRd+(1-Rf)*dRd*((limit(V(Tj),-200,999)+T0)/Tref)**nmu)}
V_sense  dd   d1  0
G_diode   s   d3  VALUE={Idiod(V(s,d3),T0+limit(V(Tj),-200,499))}
G_Rdio   d2   d1  VALUE={V(d2,d1)/(dRdi*((limit(V(Tj),-200,999)+T0)/Tref)**nmu2)}
V_sense2 d2   d3  0

L_L001    a    c  {td/(ta+td)}
R_R001    a    b  {1/ta}
V_sense3  c    0  0
E_E001    b    0  VALUE {I(V_sense2)}
E_E002    e    0  VALUE {Cds0*1/(1-nd)*U0**nd*(limit(U0+V(d1,s),0,2*UB))**(1-nd)}
R_R002    e    c  1
R_R003    a    0  500Meg

R1        g    s  1G
Rd01      d    s  500Meg
Rd02     d2    s  500Meg
Rd03     d1    d  1k

Rmet      s    s0 {Rm}

G_TH      0   Tj  VALUE =
+ {(limit(I(V_sense2)*V(d1,s)+(V(s,s0)**2)/Rm+(I(V_sense)-I(V_sense2))*V(d1,d)+
+ (I(V_sense)-I(V_sense2)-I(E_Edg)-I(Vx)-I(E_Eds))*V(d,s),-10k,100k))}

.ENDS

*********

.SUBCKT S4_30_h_var1 dd g s0 Tj PARAMS: a=1 dVth=0 dR=0 dgfs=0 Inn=1 Unn=1 Rmax=1
+ gmin=1 Rs=1 Rp=1 dC=0 Rm=1u

.PARAM  Fm=0.2       Fn=0.5
.PARAM  c=1.21       Vth0=2.73   auth=2.35m
.PARAM  UT=100m      ab=20m      lB=-23       UB=39.4

.PARAM  b0=123       p0=7.71     p1=-33m      p2=54u

.PARAM  Rd=6.36m     nmu=3.21    Tref=298     T0=273       lnIsj=-28
.PARAM  ndi=1        Rdi=2.19m   nmu2=0.55    ta=3n        td=20n
.PARAM  Rf=0.722     nmu3=1.38

.PARAM  f1=210p      f2=680p     f3=870p      U0=12       nc=2    nd=1.3
.PARAM  g1=0.15      bb=1        remp=0.01p   f2r=400p
.PARAM  kbq=85.8u

.PARAM  Vmin=2.33     Vmax=3.13    dCmax=0.33
.PARAM  Vth={Vth0+(Vmax-Vth0)*limit(dVth,0,1)-(Vmin-Vth0)*limit(dVth,-1,0)}
.PARAM  q0={b0*((T0/Tref)**nmu3)*a}
.PARAM  q1={(Unn-Inn*Rs-Vth0)*q0}
.PARAM  q2={(Fm*sqrt(0.4)-c)*Inn*q0}
.PARAM  Rlim={(q1+2*q2*Rmax-sqrt(max(q1**2+4*q2,0)))/(2*q2)}
.PARAM  dRd={Rd/a+if(dVth==0,limit(dR,0,1)*max(Rlim-Rd/a-Rs-Rp,0),0)}
.PARAM  bm={c/((1/gmin-Rs)**2*Inn*a*(T0/Tref)**nmu3)}
.PARAM  bet={b0+(b0-bm)*if(dR==0,if(dVth==0,limit(dgfs,-1,0),0),0)}
.PARAM  dC1={1+dCmax*limit(dC,0,1)}
.PARAM  dC2={1+1.5*dCmax*limit(dC,0,1)}

.PARAM  Cox={f1*a*dC2}
.PARAM  Cox1={remp*sqrt(a)*dC2}
.PARAM  Cds0={(f2*a+f2r*sqrt(a))*dC1}
.PARAM  Cgs0={f3*a*dC1}
.PARAM  dRdi={Rdi/a}

.FUNC  I0(Uee,p,pp,z1)  {if(Uee>pp,(Uee-c*z1)*z1,p*(pp-p)/c*exp((Uee-pp)/p))}
.FUNC  Ig(Uds,T,p,Uee)  {bet*(T0/T)**nmu3*I0(Uee,p,min(2*p,p+c*Uds),min(Uds,Uee/(2*c)))}
.FUNC  J(d,g,T,da) 
+ {a*(sgn(d)*Ig(da,T,(p0+(p1+p2*T)*T)*kbq*T,g-Vth+auth*(T-Tref)+Fm*da**Fn+1*limit(-d,0,1)))}

E_Edg     d   ox  VALUE {max(V(d,g),-bb)-(1/(g1*(1-nc))*((1/(1+g1*max(V(d,g)+(bb),0)))**(nc-1)-(1/(1+g1*bb))**(nc-1)))}
C_Cdg    ox   g   {Cox}
C_Cdg1   d    g   {Cox1}

E_Eds    d    edep  VALUE {V(d,s)-1/(1-nd)*U0*((limit(1+V(d,s)/U0,0,2*UB))**(1-nd)-1)}
C_Cds  edep    s  {Cds0*0.99}

Dbody s dd dbody
.model dbody D (BV= {UB},CJO ={Cds0/100},TT ={ta},IS ={a*exp(lnIsj)} m={0.3} RS={dRdi} )

C_Cgs   g    s   {Cgs0}

G_chan    d    s VALUE={J(V(d,s),V(g,s),T0+limit(V(Tj),-200,300),abs(V(d,s)))}
G_RMos   dd    d  VALUE={V(dd,d)/(Rf*dRd+(1-Rf)*dRd*((limit(V(Tj),-200,999)+T0)/Tref)**nmu)}

R1        g    s  1G
Rd01      d    s  500Meg
Rd03     dd    d  1k
Rd04     g     d  500Meg

Rmet      s    s0 {Rm}  TC=4m

Rx Tj 0 1k

.ENDS

*********

.SUBCKT S4_30_m_var dd g s0 Tj PARAMS: a=1 dVth=0 dR=0 dgfs=0 Inn=1 Unn=1 Rmax=1
+ gmin=1 Rs=1 Rp=1 dC=0 Rm=1u

.PARAM  Fm=0.15      Fn=0.5      al=0.5
.PARAM  c=1.7        Vth0=2.355  auth=2.485m
.PARAM  UT=100m      ab=20m      lB=-23       UB=39.9

.PARAM  b0=170       p0=5.803     p1=-21.2m   p2=35.5u

.PARAM  Rd=6.54m     nmu=3.05    Tref=298     T0=273       lnIsj=-25.727
.PARAM  ndi=1.113    Rdi=2.1m    nmu2=0.70    ta=3n        td=20n
.PARAM  Rf=0.675     nmu3=1.5

.PARAM  f1=280p      f2=680p     f3=1.15n     U0=12        nc=2    nd=1.3
.PARAM  g1=0.15      bb=1        remp=0.01p   f2r=400p
.PARAM  kbq=85.8u

.PARAM  Vmin=1.855     Vmax=2.855    dCmax=0.33
.PARAM  Vth={Vth0+(Vmax-Vth0)*limit(dVth,0,1)-(Vmin-Vth0)*limit(dVth,-1,0)}
.PARAM  q0={b0*((T0/Tref)**nmu3)*a}
.PARAM  q1={(Unn-Inn*Rs-Vth0)*q0}
.PARAM  q2={(Fm*sqrt(0.4)-c)*Inn*q0}
.PARAM  Rlim={(q1+2*q2*Rmax-sqrt(max(q1**2+4*q2,0)))/(2*q2)}
.PARAM  dRd={Rd/a+if(dVth==0,limit(dR,0,1)*max(Rlim-Rd/a-Rs-Rp,0),0)}
.PARAM  bm={c/((1/gmin-Rs)**2*Inn*a*(T0/Tref)**nmu3)}
.PARAM  bet={b0+(b0-bm)*if(dR==0,if(dVth==0,limit(dgfs,-1,0),0),0)}
.PARAM  dC1={1+dCmax*limit(dC,0,1)}
.PARAM  dC2={1+1.5*dCmax*limit(dC,0,1)}

.PARAM  Cox={f1*a*dC2}
.PARAM  Cox1={remp*sqrt(a)*dC2}
.PARAM  Cds0={(f2*a+f2r*sqrt(a))*dC1}
.PARAM  Cgs0={f3*a*dC1}
.PARAM  dRdi={Rdi/a}

.FUNC  I0(Uee,p,pp,z1)  {if(Uee>pp,(Uee-c*z1)*z1,p*(pp-p)/c*exp((Uee-pp)/p))}
.FUNC  Ig(Uds,T,p,Uee)  {bet*(T0/T)**nmu3*I0(Uee,p,min(2*p,p+c*Uds),min(Uds,Uee/(2*c)))}
.FUNC J(d,g,T,da,s) 
+ {a*(s*(Ig(da,T,(p0+(p1+p2*T)*T)*kbq*T,g-Vth+auth*(T-Tref)+Fm*da**Fn+1*limit(-d,0,1))+
+ exp(min(lB+(abs(d)-UB-ab*(T-Tref))/UT,25))))}

.FUNC  Idiode(Usd,Tj,Iss) {exp(min(log(Iss)+Usd/(ndi*kbq*Tj),7))-Iss}
.FUNC  Idiod(Usd,Tj)      {a*Idiode(Usd,Tj,exp(min(lnIsj+(Tj/Tref-1)*1.12/(ndi*kbq*Tj),7))*(Tj/Tref)**3)}

E_Edg     d   ox  VALUE {max(V(d,g),-bb)-(1/(g1*(1-nc))*((1/(1+g1*max(V(d,g)+(bb),0)))**(nc-1)-(1/(1+g1*bb))**(nc-1)))}
C_Cdg    ox    g  {Cox}
Vx        d   ox1 0
C_Cdg1   ox1   g  {Cox1}

E_Eds     d edep  VALUE {(V(d,s)-I(V_sense3)/Cds0)}
C_Cds  edep    s  {Cds0}

C_Cgs   g    s   {Cgs0}

G_chan    d    s VALUE={J(V(d,s),V(g,s),T0+limit(V(Tj),-200,300),(sqrt(1+4*al*abs(V(d,s)))-1)/2/al,sgn(V(d,s)))}
G_RMos   d1    d  VALUE={V(d1,d)/(Rf*dRd+(1-Rf)*dRd*((limit(V(Tj),-200,999)+T0)/Tref)**nmu)}
V_sense  dd   d1  0
G_diode   s   d3  VALUE={Idiod(V(s,d3),T0+limit(V(Tj),-200,499))}
G_Rdio   d2   d1  VALUE={V(d2,d1)/(dRdi*((limit(V(Tj),-200,999)+T0)/Tref)**nmu2)}
V_sense2 d2   d3  0

L_L001    a    c  {td/(ta+td)}
R_R001    a    b  {1/ta}
V_sense3  c    0  0
E_E001    b    0  VALUE {I(V_sense2)}
E_E002    e    0  VALUE {Cds0*1/(1-nd)*U0**nd*(limit(U0+V(d1,s),0,2*UB))**(1-nd)}
R_R002    e    c  1
R_R003    a    0  500Meg

R1        g    s  1G
Rd01      d    s  500Meg
Rd02     d2    s  500Meg
Rd03     d1    d  1k

Rmet      s    s0 {Rm}

G_TH      0   Tj  VALUE =
+ {(limit(I(V_sense2)*V(d1,s)+(V(s,s0)**2)/Rm+(I(V_sense)-I(V_sense2))*V(d1,d)+
+ (I(V_sense)-I(V_sense2)-I(E_Edg)-I(Vx)-I(E_Eds))*V(d,s),-10k,100k))}

.ENDS

*********

.SUBCKT S4_30_m_var1 dd g s0 Tj PARAMS: a=1 dVth=0 dR=0 dgfs=0 Inn=1 Unn=1 Rmax=1
+ gmin=1 Rs=1 Rp=1 dC=0 Rm=1u

.PARAM  Fm=0.15      Fn=0.5
.PARAM  c=1.7        Vth0=2.355  auth=2.485m
.PARAM  UT=100m      ab=20m      lB=-23       UB=39.9

.PARAM  b0=170       p0=5.803     p1=-21.2m   p2=35.5u     al=0.5 

.PARAM  Rd=6.54m     nmu=3.05    Tref=298     T0=273       lnIsj=-28.2
.PARAM  ndi=1        Rdi=2.1m    nmu2=0.70    ta=3n        td=20n
.PARAM  Rf=0.675     nmu3=1.5

.PARAM  f1=280p      f2=680p     f3=1.15n     U0=12        nc=2    nd=1.3
.PARAM  g1=0.15      bb=1        remp=0.01p   f2r=400p
.PARAM  kbq=85.8u

.PARAM  Vmin=1.855     Vmax=2.855    dCmax=0.33
.PARAM  Vth={Vth0+(Vmax-Vth0)*limit(dVth,0,1)-(Vmin-Vth0)*limit(dVth,-1,0)}
.PARAM  q0={b0*((T0/Tref)**nmu3)*a}
.PARAM  q1={(Unn-Inn*Rs-Vth0)*q0}
.PARAM  q2={(Fm*sqrt(0.4)-c)*Inn*q0}
.PARAM  Rlim={(q1+2*q2*Rmax-sqrt(max(q1**2+4*q2,0)))/(2*q2)}
.PARAM  dRd={Rd/a+if(dVth==0,limit(dR,0,1)*max(Rlim-Rd/a-Rs-Rp,0),0)}
.PARAM  bm={c/((1/gmin-Rs)**2*Inn*a*(T0/Tref)**nmu3)}
.PARAM  bet={b0+(b0-bm)*if(dR==0,if(dVth==0,limit(dgfs,-1,0),0),0)}
.PARAM  dC1={1+dCmax*limit(dC,0,1)}
.PARAM  dC2={1+1.5*dCmax*limit(dC,0,1)}

.PARAM  Cox={f1*a*dC2}
.PARAM  Cox1={remp*sqrt(a)*dC2}
.PARAM  Cds0={(f2*a+f2r*sqrt(a))*dC1}
.PARAM  Cgs0={f3*a*dC1}
.PARAM  dRdi={Rdi/a}

.FUNC  I0(Uee,p,pp,z1)  {if(Uee>pp,(Uee-c*z1)*z1,p*(pp-p)/c*exp((Uee-pp)/p))}
.FUNC  Ig(Uds,T,p,Uee)  {bet*(T0/T)**nmu3*I0(Uee,p,min(2*p,p+c*Uds),min(Uds,Uee/(2*c)))}
.FUNC  J(d,g,T,da) 
+ {a*(sgn(d)*Ig(da,T,(p0+(p1+p2*T)*T)*kbq*T,g-Vth+auth*(T-Tref)+Fm*da**Fn+1*limit(-d,0,1)))}

E_Edg     d   ox  VALUE {max(V(d,g),-bb)-(1/(g1*(1-nc))*((1/(1+g1*max(V(d,g)+(bb),0)))**(nc-1)-(1/(1+g1*bb))**(nc-1)))}
C_Cdg    ox   g   {Cox}
C_Cdg1   d    g   {Cox1}

E_Eds    d    edep  VALUE {V(d,s)-1/(1-nd)*U0*((limit(1+V(d,s)/U0,0,2*UB))**(1-nd)-1)}
C_Cds  edep    s  {Cds0*0.99}

Dbody s dd dbody
.model dbody D (BV= {UB},CJO ={Cds0/100},TT ={ta},IS ={a*exp(lnIsj)} m={0.3} RS={dRdi} )

C_Cgs   g    s   {Cgs0}

G_chan    d    s VALUE={J(V(d,s),V(g,s),T0+limit(V(Tj),-200,300),(sqrt(1+4*al*abs(V(d,s)))-1)/2/al)}
G_RMos   dd    d  VALUE={V(dd,d)/(Rf*dRd+(1-Rf)*dRd*((limit(V(Tj),-200,999)+T0)/Tref)**nmu)}

R1        g    s  1G
Rd01      d    s  500Meg
Rd03     dd    d  1k
Rd04     g     d  500Meg

Rmet      s    s0 {Rm}  TC=4m

Rx Tj 0 1k

.ENDS



********************************************************************************
* Level 3 Models
********************************************************************************

.SUBCKT IPB180N03S4L_H0 drain gate source Tj Tcase PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 dZth=0 Ls=1.8n Ld=1n Lg=4n

.PARAM Rs=327u      Rg=1.8       Rd=20u       Rm=60u
.PARAM Inn=100      Unn=10       Rmax=0.9m    gmin=189.87
.PARAM RRf=382m     Rrbond=5m    Rtb=3.6      g2=647m
.PARAM act=19.92

.FUNC   Pb(I,dT,Rb)  {Rb/(2*Rtb)*(I-limit(dT/(max(I,1n)*Rb)+RRf*I*g2,0,I))**2}

X1  d1 g s Tj S4_30_h_var PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}
Rsb   source s1    10
Rga   gate   g1    10
Rdb   drain  d2    10

G_TH  0    Tb  VALUE =  {Pb(abs(I(Ls)),V(Tj,Tcase),Rrbond*(1+(limit((V(Tb)+V(Tj))/2,-200,999)-25)*4m))}
Cthb  Tb      0               9.75m
Rthb  Tb      Tj              {Rtb} 
Rth1  Tj      t1              {1.32m+limit(dZth,0,1)*489.95u}
Rth2  t1      t2              {18.01m+limit(dZth,0,1)*6.67m}
Rth3  t2      t3              {71.88m+limit(dZth,0,1)*21.85m}
Rth4  t3      t4              {88.88m+limit(dZth,0,1)*58.99m}
Rth5  t4      Tcase           {199.5m+limit(dZth,0,1)*132.41m}
Cth1  Tj      0               138.665u
Cth2  t1      0               776.705u
Cth3  t2      0               4.614m
Cth4  t3      0               3.386m
Cth5  t4      0               108.248m
Cth6  Tcase   0               190m

.ENDS

**********

.SUBCKT IPB180N03S4L_01 drain gate source Tj Tcase PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 dZth=0 Ls=1.8n Ld=1n Lg=4n

.PARAM Rs=335u      Rg=1.7       Rd=20u       Rm=68u
.PARAM Inn=100      Unn=10       Rmax=1m      gmin=162.06
.PARAM RRf=382m     Rrbond=5m    Rtb=3.6      g2=647m
.PARAM act=14.1

.FUNC   Pb(I,dT,Rb)  {Rb/(2*Rtb)*(I-limit(dT/(max(I,1n)*Rb)+RRf*I*g2,0,I))**2}

X1  d1 g s Tj S4_30_h_var PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}
Rsb   source s1    10
Rga   gate   g1    10
Rdb   drain  d2    10

G_TH  0    Tb  VALUE =  {Pb(abs(I(Ls)),V(Tj,Tcase),Rrbond*(1+(limit((V(Tb)+V(Tj))/2,-200,999)-25)*4m))}
Cthb  Tb      0               9.75m
Rthb  Tb      Tj              {Rtb} 
Rth1  Tj      t1              {1.87m+limit(dZth,0,1)*686.75u}
Rth2  t1      t2              {25.27m+limit(dZth,0,1)*9.36m}
Rth3  t2      t3              {99.66m+limit(dZth,0,1)*30.93m}
Rth4  t3      t4              {125.56m+limit(dZth,0,1)*95.13m}
Rth5  t4      Tcase           {234.14m+limit(dZth,0,1)*177.39m}
Cth1  Tj      0               98.152u
Cth2  t1      0               553.551u
Cth3  t2      0               3.342m
Cth4  t3      0               2.397m
Cth5  t4      0               86.098m
Cth6  Tcase   0               190m

.ENDS

**********

.SUBCKT IPD90N03S4L_02 drain gate source Tj Tcase PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 dZth=0 Ls=1.5n Ld=1n Lg=3n

.PARAM Rs=829u      Rg=1.7       Rd=50u       Rm=350u
.PARAM Inn=90       Unn=10       Rmax=2.2m    gmin=111.51
.PARAM RRf=390m     Rrbond=12m   Rtb=5.5      g2=758m
.PARAM act=8.48

.FUNC   Pb(I,dT,Rb)  {Rb/(2*Rtb)*(I-limit(dT/(max(I,1n)*Rb)+RRf*I*g2,0,I))**2}

X1  d1 g s Tj S4_30_h_var PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}
Rsb   source s1    10
Rga   gate   g1    10
Rdb   drain  d2    10

G_TH  0    Tb  VALUE =  {Pb(abs(I(Ls)),V(Tj,Tcase),Rrbond*(1+(limit((V(Tb)+V(Tj))/2,-200,999)-25)*4m))}
Cthb  Tb      0               3.71m
Rthb  Tb      Tj              {Rtb} 
Rth1  Tj      t1              {3.1m+limit(dZth,0,1)*1.15m}
Rth2  t1      t2              {41.51m+limit(dZth,0,1)*15.36m}
Rth3  t2      t3              {160.69m+limit(dZth,0,1)*51.63m}
Rth4  t3      t4              {168.56m+limit(dZth,0,1)*142.96m}
Rth5  t4      Tcase           {278.68m+limit(dZth,0,1)*236.36m}
Cth1  Tj      0               59.03u
Cth2  t1      0               337.077u
Cth3  t2      0               2.088m
Cth4  t3      0               1.494m
Cth5  t4      0               35.339m
Cth6  Tcase   0               70m

.ENDS

**********

.SUBCKT IPB80N03S4L_02 drain gate source Tj Tcase PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 dZth=0 Ls=2n Ld=1n Lg=4n

.PARAM Rs=1.05m     Rg=1.7       Rd=50u       Rm=350u
.PARAM Inn=80       Unn=10       Rmax=2.4m    gmin=101.76
.PARAM RRf=451m     Rrbond=35m   Rtb=9.3      g2=824m
.PARAM act=8.48

.FUNC   Pb(I,dT,Rb)  {Rb/(2*Rtb)*(I-limit(dT/(max(I,1n)*Rb)+RRf*I*g2,0,I))**2}

X1  d1 g s Tj S4_30_h_var PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}
Rsb   source s1    10
Rga   gate   g1    10
Rdb   drain  d2    10

G_TH  0    Tb  VALUE =  {Pb(abs(I(Ls)),V(Tj,Tcase),Rrbond*(1+(limit((V(Tb)+V(Tj))/2,-200,999)-25)*4m))}
Cthb  Tb      0               6.24m
Rthb  Tb      Tj              {Rtb} 
Rth1  Tj      t1              {3.1m+limit(dZth,0,1)*1.15m}
Rth2  t1      t2              {41.51m+limit(dZth,0,1)*15.36m}
Rth3  t2      t3              {160.69m+limit(dZth,0,1)*51.63m}
Rth4  t3      t4              {208.78m+limit(dZth,0,1)*132.01m}
Rth5  t4      Tcase           {297.6m+limit(dZth,0,1)*188.17m}
Cth1  Tj      0               59.03u
Cth2  t1      0               337.077u
Cth3  t2      0               2.088m
Cth4  t3      0               1.441m
Cth5  t4      0               64.412m
Cth6  Tcase   0               190m

.ENDS

**********

.SUBCKT IPD70N03S4L_04 drain gate source Tj Tcase PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 dZth=0 Ls=1.5n Ld=1n Lg=3n

.PARAM Rs=891u      Rg=1.5       Rd=50u       Rm=253u
.PARAM Inn=70       Unn=10       Rmax=4.3m    gmin=60
.PARAM RRf=455m     Rrbond=30m   Rtb=8.6      g2=830m
.PARAM act=2.88

.FUNC   Pb(I,dT,Rb)  {Rb/(2*Rtb)*(I-limit(dT/(max(I,1n)*Rb)+RRf*I*g2,0,I))**2}

X1  d1 g s Tj S4_30_h_var PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}
Rsb   source s1    10
Rga   gate   g1    10
Rdb   drain  d2    10

G_TH  0    Tb  VALUE =  {Pb(abs(I(Ls)),V(Tj,Tcase),Rrbond*(1+(limit((V(Tb)+V(Tj))/2,-200,999)-25)*4m))}
Cthb  Tb      0               2.37m
Rthb  Tb      Tj              {Rtb} 
Rth1  Tj      t1              {9.14m+limit(dZth,0,1)*3.38m}
Rth2  t1      t2              {117.52m+limit(dZth,0,1)*43.5m}
Rth3  t2      t3              {428.1m+limit(dZth,0,1)*153.75m}
Rth4  t3      t4              {496.3m+limit(dZth,0,1)*261.88m}
Rth5  t4      Tcase           {449.33m+limit(dZth,0,1)*237.1m}
Cth1  Tj      0               20.048u
Cth2  t1      0               119.045u
Cth3  t2      0               804.583u
Cth4  t3      0               507.511u
Cth5  t4      0               25.227m
Cth6  Tcase   0               70m

.ENDS

**********

.SUBCKT IPB80N03S4L_03 drain gate source Tj Tcase PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 dZth=0 Ls=2n Ld=1n Lg=4n

.PARAM Rs=941u      Rg=1.6       Rd=50u       Rm=244u
.PARAM Inn=30       Unn=10       Rmax=3.4m    gmin=49
.PARAM RRf=451m     Rrbond=35m   Rtb=9.3      g2=824m
.PARAM act=4.466

.FUNC   Pb(I,dT,Rb)  {Rb/(2*Rtb)*(I-limit(dT/(max(I,1n)*Rb)+RRf*I*g2,0,I))**2}

X1  d1 g s Tj S4_30_h_var PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}
Rsb   source s1    10
Rga   gate   g1    10
Rdb   drain  d2    10

G_TH  0    Tb  VALUE =  {Pb(abs(I(Ls)),V(Tj,Tcase),Rrbond*(1+(limit((V(Tb)+V(Tj))/2,-200,999)-25)*4m))}
Cthb  Tb      0               6.24m
Rthb  Tb      Tj              {Rtb} 
Rth1  Tj      t1              {5.89m+limit(dZth,0,1)*2.18m}
Rth2  t1      t2              {77.19m+limit(dZth,0,1)*28.57m}
Rth3  t2      t3              {291.51m+limit(dZth,0,1)*98.63m}
Rth4  t3      t4              {335.11m+limit(dZth,0,1)*161.03m}
Rth5  t4      Tcase           {405.19m+limit(dZth,0,1)*194.7m}
Cth1  Tj      0               31.088u
Cth2  t1      0               181.243u
Cth3  t2      0               1.165m
Cth4  t3      0               759.153u
Cth5  t4      0               47.92m
Cth6  Tcase   0               190m

.ENDS

**********

.SUBCKT IPD90N03S4L_03 drain gate source Tj Tcase PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 dZth=0 Ls=1.5n Ld=1n Lg=3n

.PARAM Rs=723u      Rg=1.6       Rd=50u       Rm=244u
.PARAM Inn=30       Unn=10       Rmax=3.1m    gmin=50
.PARAM RRf=390m     Rrbond=12m   Rtb=5.5      g2=758m
.PARAM act=4.466

.FUNC   Pb(I,dT,Rb)  {Rb/(2*Rtb)*(I-limit(dT/(max(I,1n)*Rb)+RRf*I*g2,0,I))**2}

X1  d1 g s Tj S4_30_h_var PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}
Rsb   source s1    10
Rga   gate   g1    10
Rdb   drain  d2    10

G_TH  0    Tb  VALUE =  {Pb(abs(I(Ls)),V(Tj,Tcase),Rrbond*(1+(limit((V(Tb)+V(Tj))/2,-200,999)-25)*4m))}
Cthb  Tb      0               3.71m
Rthb  Tb      Tj              {Rtb} 
Rth1  Tj      t1              {5.89m+limit(dZth,0,1)*2.18m}
Rth2  t1      t2              {77.19m+limit(dZth,0,1)*28.57m}
Rth3  t2      t3              {291.51m+limit(dZth,0,1)*98.63m}
Rth4  t3      t4              {320.05m+limit(dZth,0,1)*180.68m}
Rth5  t4      Tcase           {380.49m+limit(dZth,0,1)*214.81m}
Cth1  Tj      0               31.088u
Cth2  t1      0               181.243u
Cth3  t2      0               1.165m
Cth4  t3      0               786.994u
Cth5  t4      0               26.188m
Cth6  Tcase   0               70m

.ENDS

**********

.SUBCKT IPD40N03S4L_08 drain gate source Tj Tcase PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 dZth=0 Ls=2n Ld=1n Lg=3n

.PARAM Rs=1.53m     Rg=1         Rd=50u       Rm=444u
.PARAM Inn=40       Unn=10       Rmax=8.3m    gmin=29.84
.PARAM RRf=489m     Rrbond=122m  Rtb=17.2     g2=907m
.PARAM act=1.26

.FUNC   Pb(I,dT,Rb)  {Rb/(2*Rtb)*(I-limit(dT/(max(I,1n)*Rb)+RRf*I*g2,0,I))**2}

X1  d1 g s Tj S4_30_h_var PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}
Rsb   source s1    10
Rga   gate   g1    10
Rdb   drain  d2    10

G_TH  0    Tb  VALUE =  {Pb(abs(I(Ls)),V(Tj,Tcase),Rrbond*(1+(limit((V(Tb)+V(Tj))/2,-200,999)-25)*4m))}
Cthb  Tb      0               1.19m
Rthb  Tb      Tj              {Rtb} 
Rth1  Tj      t1              {20.89m+limit(dZth,0,1)*7.73m}
Rth2  t1      t2              {256.3m+limit(dZth,0,1)*94.85m}
Rth3  t2      t3              {877.29m+limit(dZth,0,1)*356m}
Rth4  t3      t4              {1.16+limit(dZth,0,1)*203.68m}
Rth5  t4      Tcase           {530.17m+limit(dZth,0,1)*93.09m}
Cth1  Tj      0               8.771u
Cth2  t1      0               54.586u
Cth3  t2      0               405.905u
Cth4  t3      0               222.036u
Cth5  t4      0               92.561m
Cth6  Tcase   0               70m

.ENDS

**********

.SUBCKT IPB20N03S4L_15 drain gate source Tj Tcase PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 dZth=0 Ls=2.5n Ld=1n Lg=4n

.PARAM Rs=3.53m     Rg=1.2       Rd=50u       Rm=660u
.PARAM Inn=20       Unn=10       Rmax=14.7m   gmin=16.54
.PARAM RRf=498m     Rrbond=1     Rtb=51.4     g2=963m
.PARAM act=0.865

.FUNC   Pb(I,dT,Rb)  {Rb/(2*Rtb)*(I-limit(dT/(max(I,1n)*Rb)+RRf*I*g2,0,I))**2}

X1  d1 g s Tj S4_30_h_var PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}
Rsb   source s1    10
Rga   gate   g1    10
Rdb   drain  d2    10

G_TH  0    Tb  VALUE =  {Pb(abs(I(Ls)),V(Tj,Tcase),Rrbond*(1+(limit((V(Tb)+V(Tj))/2,-200,999)-25)*4m))}
Cthb  Tb      0               1.12m
Rthb  Tb      Tj              {Rtb} 
Rth1  Tj      t1              {30.43m+limit(dZth,0,1)*11.26m}
Rth2  t1      t2              {362.97m+limit(dZth,0,1)*134.33m}
Rth3  t2      t3              {1.24+limit(dZth,0,1)*520.11m}
Rth4  t3      t4              {1.36+limit(dZth,0,1)*193.86m}
Rth5  t4      Tcase           {916.41m+limit(dZth,0,1)*130.63m}
Cth1  Tj      0               6.021u
Cth2  t1      0               38.544u
Cth3  t2      0               291.146u
Cth4  t3      0               147.037u
Cth5  t4      0               39.549m
Cth6  Tcase   0               190m

.ENDS

**********

.SUBCKT IPD30N03S4L_14 drain gate source Tj Tcase PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 dZth=0 Ls=2n Ld=1n Lg=3n

.PARAM Rs=2.35m     Rg=1.2       Rd=50u       Rm=660u
.PARAM Inn=30       Unn=10       Rmax=13.5m   gmin=21
.PARAM RRf=496m     Rrbond=345m  Rtb=28.9     g2=943m
.PARAM act=0.865

.FUNC   Pb(I,dT,Rb)  {Rb/(2*Rtb)*(I-limit(dT/(max(I,1n)*Rb)+RRf*I*g2,0,I))**2}

X1  d1 g s Tj S4_30_h_var PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}
Rsb   source s1    10
Rga   gate   g1    10
Rdb   drain  d2    10

G_TH  0    Tb  VALUE =  {Pb(abs(I(Ls)),V(Tj,Tcase),Rrbond*(1+(limit((V(Tb)+V(Tj))/2,-200,999)-25)*4m))}
Cthb  Tb      0               632.1u
Rthb  Tb      Tj              {Rtb} 
Rth1  Tj      t1              {30.43m+limit(dZth,0,1)*11.26m}
Rth2  t1      t2              {362.97m+limit(dZth,0,1)*134.33m}
Rth3  t2      t3              {1.24+limit(dZth,0,1)*520.11m}
Rth4  t3      t4              {1.7+limit(dZth,0,1)*300.83m}
Rth5  t4      Tcase           {509.85m+limit(dZth,0,1)*90.22m}
Cth1  Tj      0               6.021u
Cth2  t1      0               38.544u
Cth3  t2      0               291.146u
Cth4  t3      0               152.429u
Cth5  t4      0               3m
Cth6  Tcase   0               70m

.ENDS

**********

.SUBCKT IPD50N03S4L_06 drain gate source Tj Tcase PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 dZth=0 Ls=2n Ld=1n Lg=3n

.PARAM Rs=1.11m     Rg=1.4       Rd=50u       Rm=348u
.PARAM Inn=30       Unn=10       Rmax=6m      gmin=34
.PARAM RRf=472m     Rrbond=50m   Rtb=11       g2=862m
.PARAM act=2.037

.FUNC   Pb(I,dT,Rb)  {Rb/(2*Rtb)*(I-limit(dT/(max(I,1n)*Rb)+RRf*I*g2,0,I))**2}

X1  d1 g s Tj S4_30_h_var PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}
Rsb   source s1    10
Rga   gate   g1    10
Rdb   drain  d2    10

G_TH  0    Tb  VALUE =  {Pb(abs(I(Ls)),V(Tj,Tcase),Rrbond*(1+(limit((V(Tb)+V(Tj))/2,-200,999)-25)*4m))}
Cthb  Tb      0               1.85m
Rthb  Tb      Tj              {Rtb} 
Rth1  Tj      t1              {12.92m+limit(dZth,0,1)*4.78m}
Rth2  t1      t2              {163.28m+limit(dZth,0,1)*60.43m}
Rth3  t2      t3              {586.93m+limit(dZth,0,1)*218.45m}
Rth4  t3      t4              {702.56m+limit(dZth,0,1)*266.76m}
Rth5  t4      Tcase           {495.68m+limit(dZth,0,1)*188.21m}
Cth1  Tj      0               14.18u
Cth2  t1      0               85.684u
Cth3  t2      0               592.268u
Cth4  t3      0               358.958u
Cth5  t4      0               29.006m
Cth6  Tcase   0               70m

.ENDS

**********

.SUBCKT IPD30N03S4L_09 drain gate source Tj Tcase PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 dZth=0 Ls=1.8n Ld=1n Lg=4n

.PARAM Rs=327u      Rg=1.5       Rd=20u       Rm=60u
.PARAM Inn=100      Unn=10       Rmax=0.95m   gmin=188.14
.PARAM RRf=382m     Rrbond=5m    Rtb=3.6      g2=647m
.PARAM act=19.79

.FUNC   Pb(I,dT,Rb)  {Rb/(2*Rtb)*(I-limit(dT/(max(I,1n)*Rb)+RRf*I*g2,0,I))**2}

X1  d1 g s Tj S4_30_h_var PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}
Rsb   source s1    10
Rga   gate   g1    10
Rdb   drain  d2    10

G_TH  0    Tb  VALUE =  {Pb(abs(I(Ls)),V(Tj,Tcase),Rrbond*(1+(limit((V(Tb)+V(Tj))/2,-200,999)-25)*4m))}
Cthb  Tb      0               9.75m
Rthb  Tb      Tj              {Rtb} 
Rth1  Tj      t1              {1.33m+limit(dZth,0,1)*492.05u}
Rth2  t1      t2              {18.13m+limit(dZth,0,1)*6.71m}
Rth3  t2      t3              {71.96m+limit(dZth,0,1)*21.99m}
Rth4  t3      t4              {89.46m+limit(dZth,0,1)*58.65m}
Rth5  t4      Tcase           {200.1m+limit(dZth,0,1)*131.18m}
Cth1  Tj      0               137.76u
Cth2  t1      0               771.728u
Cth3  t2      0               4.614m
Cth4  t3      0               3.364m
Cth5  t4      0               107.749m
Cth6  Tcase   0               190m

.ENDS


********************************************************************************
* Special Level 3 Models
********************************************************************************

.SUBCKT IPD135N03L drain gate source Tj Tcase PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 dZth=0 Ls=2n Ld=1n Lg=3n

.PARAM Rs=2.35m     Rg=1.2       Rd=50u       Rm=660u
.PARAM Inn=30       Unn=10       Rmax=13.5m   gmin=21
.PARAM RRf=496m     Rrbond=345m  Rtb=28.9     g2=943m
.PARAM act=0.865

.FUNC   Pb(I,dT,Rb)  {Rb/(2*Rtb)*(I-limit(dT/(max(I,1n)*Rb)+RRf*I*g2,0,I))**2}

X1  d1 g s Tj S4_30_h_var PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}
Rsb   source s1    10
Rga   gate   g1    10
Rdb   drain  d2    10

G_TH  0    Tb  VALUE =  {Pb(abs(I(Ls)),V(Tj,Tcase),Rrbond*(1+(limit((V(Tb)+V(Tj))/2,-200,999)-25)*4m))}
Cthb  Tb      0               632.1u
Rthb  Tb      Tj              {Rtb} 
Rth1  Tj      t1              {30.43m+limit(dZth,0,1)*11.26m}
Rth2  t1      t2              {362.97m+limit(dZth,0,1)*134.33m}
Rth3  t2      t3              {1.24+limit(dZth,0,1)*520.11m}
Rth4  t3      t4              {1.7+limit(dZth,0,1)*300.83m}
Rth5  t4      Tcase           {509.85m+limit(dZth,0,1)*90.22m}
Cth1  Tj      0               6.021u
Cth2  t1      0               38.544u
Cth3  t2      0               291.146u
Cth4  t3      0               152.429u
Cth5  t4      0               3m
Cth6  Tcase   0               70m

.ENDS



********************************************************************************
* Level 1 Models
********************************************************************************

.SUBCKT IPB180N03S4L_H0_L1 drain gate source PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 Ls=1.8n Ld=1n Lg=4n

.PARAM Rs=327u      Rg=1.8       Rd=20u       Rm=60u
.PARAM Inn=100      Unn=10       Rmax=0.9m    gmin=189.87
.PARAM act=19.92

X1  d1 g s Tj S4_30_h_var1 PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}

E1    Tj     w      VALUE={TEMP}
R1    w      0      1u

.ENDS

**********

.SUBCKT IPB180N03S4L_01_L1 drain gate source PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 Ls=1.8n Ld=1n Lg=4n

.PARAM Rs=335u      Rg=1.7       Rd=20u       Rm=68u
.PARAM Inn=100      Unn=10       Rmax=1m      gmin=162.06
.PARAM act=14.1

X1  d1 g s Tj S4_30_h_var1 PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}

E1    Tj     w      VALUE={TEMP}
R1    w      0      1u

.ENDS

**********

.SUBCKT IPD90N03S4L_02_L1 drain gate source PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 Ls=1.5n Ld=1n Lg=3n

.PARAM Rs=829u      Rg=1.7       Rd=50u       Rm=350u
.PARAM Inn=90       Unn=10       Rmax=2.2m    gmin=111.51
.PARAM act=8.48

X1  d1 g s Tj S4_30_h_var1 PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}

E1    Tj     w      VALUE={TEMP}
R1    w      0      1u

.ENDS

**********

.SUBCKT IPB80N03S4L_02_L1 drain gate source PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 Ls=2n Ld=1n Lg=4n

.PARAM Rs=1.05m     Rg=1.7       Rd=50u       Rm=350u
.PARAM Inn=80       Unn=10       Rmax=2.4m    gmin=101.76
.PARAM act=8.48

X1  d1 g s Tj S4_30_h_var1 PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}

E1    Tj     w      VALUE={TEMP}
R1    w      0      1u

.ENDS

**********

.SUBCKT IPD70N03S4L_04_L1 drain gate source PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 Ls=1.5n Ld=1n Lg=3n

.PARAM Rs=891u      Rg=1.5       Rd=50u       Rm=253u
.PARAM Inn=70       Unn=10       Rmax=4.3m    gmin=60
.PARAM act=2.88

X1  d1 g s Tj S4_30_h_var1 PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}

E1    Tj     w      VALUE={TEMP}
R1    w      0      1u

.ENDS

**********

.SUBCKT IPB80N03S4L_03_L1 drain gate source PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 Ls=2n Ld=1n Lg=4n

.PARAM Rs=941u      Rg=1.6       Rd=50u       Rm=244u
.PARAM Inn=30       Unn=10       Rmax=3.4m    gmin=49
.PARAM act=4.466

X1  d1 g s Tj S4_30_h_var1 PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}

E1    Tj     w      VALUE={TEMP}
R1    w      0      1u

.ENDS

**********

.SUBCKT IPD90N03S4L_03_L1 drain gate source PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 Ls=1.5n Ld=1n Lg=3n

.PARAM Rs=723u      Rg=1.6       Rd=50u       Rm=244u
.PARAM Inn=30       Unn=10       Rmax=3.1m    gmin=50
.PARAM act=4.466

X1  d1 g s Tj S4_30_h_var1 PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}

E1    Tj     w      VALUE={TEMP}
R1    w      0      1u

.ENDS

**********

.SUBCKT IPD40N03S4L_08_L1 drain gate source PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 Ls=2n Ld=1n Lg=3n

.PARAM Rs=1.53m     Rg=1         Rd=50u       Rm=444u
.PARAM Inn=40       Unn=10       Rmax=8.3m    gmin=29.84
.PARAM act=1.26

X1  d1 g s Tj S4_30_h_var1 PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}

E1    Tj     w      VALUE={TEMP}
R1    w      0      1u

.ENDS

**********

.SUBCKT IPB20N03S4L_15_L1 drain gate source PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 Ls=2.5n Ld=1n Lg=4n

.PARAM Rs=3.53m     Rg=1.2       Rd=50u       Rm=660u
.PARAM Inn=20       Unn=10       Rmax=14.7m   gmin=16.54
.PARAM act=0.865

X1  d1 g s Tj S4_30_h_var1 PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}

E1    Tj     w      VALUE={TEMP}
R1    w      0      1u

.ENDS

**********

.SUBCKT IPD30N03S4L_14_L1 drain gate source PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 Ls=2n Ld=1n Lg=3n

.PARAM Rs=2.35m     Rg=1.2       Rd=50u       Rm=660u
.PARAM Inn=30       Unn=10       Rmax=13.5m   gmin=21
.PARAM act=0.865

X1  d1 g s Tj S4_30_h_var1 PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}

E1    Tj     w      VALUE={TEMP}
R1    w      0      1u

.ENDS

**********

.SUBCKT IPD50N03S4L_06_L1 drain gate source PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 Ls=2n Ld=1n Lg=3n

.PARAM Rs=1.11m     Rg=1.4       Rd=50u       Rm=348u
.PARAM Inn=30       Unn=10       Rmax=6m      gmin=34
.PARAM act=2.037

X1  d1 g s Tj S4_30_h_var1 PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}

E1    Tj     w      VALUE={TEMP}
R1    w      0      1u

.ENDS

**********

.SUBCKT IPD30N03S4L_09_L1 drain gate source PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 Ls=1.8n Ld=1n Lg=4n

.PARAM Rs=327u      Rg=1.5       Rd=20u       Rm=60u
.PARAM Inn=100      Unn=10       Rmax=0.95m   gmin=188.14
.PARAM act=19.79

X1  d1 g s Tj S4_30_h_var1 PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}

E1    Tj     w      VALUE={TEMP}
R1    w      0      1u

.ENDS


********************************************************************************
* Special Level 1 Models
********************************************************************************

.SUBCKT IPD135N03L_L1 drain gate source PARAMS: dVth=0 dRdson=0 dgfs=0 dC=0 Ls=2n Ld=1n Lg=3n

.PARAM Rs=2.35m     Rg=1.2       Rd=50u       Rm=660u
.PARAM Inn=30       Unn=10       Rmax=13.5m   gmin=21
.PARAM act=0.865

X1  d1 g s Tj S4_30_h_var1 PARAMS: a={act} dVth={dVth} dR={dRdson} dgfs={dgfs} Inn={Inn} Unn={Unn} 
+                                         Rmax={Rmax} gmin={gmin} Rs={Rs} Rp={Rd} dC={dC} Rm={Rm}
Rg    g1     g    {Rg}   
Lg    gate   g1   {Lg*if(dgfs==99,0,1)}
Gs    s1     s    VALUE={V(s1,s)/(Rs*(1+(limit(V(Tj),-200,999)-25)*4m)-Rm)}
Rsa   s1     s    1Meg
Ls    source s1   {Ls*if(dgfs==99,0,1)}
Rda   d1     d2   {Rd}
Ld    drain  d2   {Ld*if(dgfs==99,0,1)}

E1    Tj     w      VALUE={TEMP}
R1    w      0      1u

.ENDS



********************************************************************************
* Level 0 Models
********************************************************************************

.SUBCKT IPB180N03S4L_H0_L0  drain  gate  source

Lg     gate  g1    4n
Ld     drain d1    1n
Ls     source s1   1.8n
Rs      s1    s2   327u

Rg     g1    g2     1.8
M1      d2    g2    s2    s2    DMOS    L=1u   W=1u
.MODEL DMOS NMOS ( KP= 1792.8  VTO=2.62  THETA=0  VMAX=1.5e5  ETA=0.015  LEVEL=3)
Rd     d1    d2    0.33m TC=7m

Dbd     s2    d2    Dbt
.MODEL     Dbt    D(BV=38   M=0.3  CJO=15.33n  VJ=0.9V)
Dbody   s2   21    DBODY
.MODEL DBODY  D(IS=151.4p  N=1.1  RS=0.03u  EG=1.12  TT=3n)
Rdiode  d1  21    0.11m TC=10m

.MODEL   sw    NMOS(VTO=0  KP=10   LEVEL=1)
Maux      g2   c    a    a   sw
Maux2     b    d    g2    g2   sw
Eaux      c    a    d2    g2   1
Eaux2     d    g2   d2    g2   -1
Cox       b    d2   4.18n
.MODEL     DGD    D(M=0.6   CJO=4.18n   VJ=0.5)
Rpar      b    d2   1Meg
Dgd       a    d2   DGD
Rpar2     d2   a    10Meg
Cgs     g2    s2    17.33n

.ENDS  IPB180N03S4L_H0_L0

******

.SUBCKT IPB180N03S4L_01_L0  drain  gate  source

Lg     gate  g1    4n
Ld     drain d1    1n
Ls     source s1   1.8n
Rs      s1    s2   335u

Rg     g1    g2     1.7
M1      d2    g2    s2    s2    DMOS    L=1u   W=1u
.MODEL DMOS NMOS ( KP= 1269  VTO=2.62  THETA=0  VMAX=1.5e5  ETA=0.015  LEVEL=3)
Rd     d1    d2    0.46m TC=7m

Dbd     s2    d2    Dbt
.MODEL     Dbt    D(BV=38   M=0.3  CJO=11.09n  VJ=0.9V)
Dbody   s2   21    DBODY
.MODEL DBODY  D(IS=107.2p  N=1.1  RS=0.04u  EG=1.12  TT=3n)
Rdiode  d1  21    0.16m TC=10m

.MODEL   sw    NMOS(VTO=0  KP=10   LEVEL=1)
Maux      g2   c    a    a   sw
Maux2     b    d    g2    g2   sw
Eaux      c    a    d2    g2   1
Eaux2     d    g2   d2    g2   -1
Cox       b    d2   2.96n
.MODEL     DGD    D(M=0.6   CJO=2.96n   VJ=0.5)
Rpar      b    d2   1Meg
Dgd       a    d2   DGD
Rpar2     d2   a    10Meg
Cgs     g2    s2    12.27n

.ENDS  IPB180N03S4L_01_L0

******

.SUBCKT IPD90N03S4L_02_L0  drain  gate  source

Lg     gate  g1    3n
Ld     drain d1    1n
Ls     source s1   1.5n
Rs      s1    s2   829u

Rg     g1    g2     1.7
M1      d2    g2    s2    s2    DMOS    L=1u   W=1u
.MODEL DMOS NMOS ( KP= 763.2  VTO=2.62  THETA=0  VMAX=1.5e5  ETA=0.015  LEVEL=3)
Rd     d1    d2    0.78m TC=7m

Dbd     s2    d2    Dbt
.MODEL     Dbt    D(BV=38   M=0.3  CJO=6.93n  VJ=0.9V)
Dbody   s2   21    DBODY
.MODEL DBODY  D(IS=64.4p  N=1.1  RS=0.06u  EG=1.12  TT=3n)
Rdiode  d1  21    0.26m TC=10m

.MODEL   sw    NMOS(VTO=0  KP=10   LEVEL=1)
Maux      g2   c    a    a   sw
Maux2     b    d    g2    g2   sw
Eaux      c    a    d2    g2   1
Eaux2     d    g2   d2    g2   -1
Cox       b    d2   1.78n
.MODEL     DGD    D(M=0.6   CJO=1.78n   VJ=0.5)
Rpar      b    d2   1Meg
Dgd       a    d2   DGD
Rpar2     d2   a    10Meg
Cgs     g2    s2    7.38n

.ENDS  IPD90N03S4L_02_L0

******

.SUBCKT IPB80N03S4L_02_L0  drain  gate  source

Lg     gate  g1    4n
Ld     drain d1    1n
Ls     source s1   2n
Rs      s1    s2   1.05m

Rg     g1    g2     1.7
M1      d2    g2    s2    s2    DMOS    L=1u   W=1u
.MODEL DMOS NMOS ( KP= 763.2  VTO=2.62  THETA=0  VMAX=1.5e5  ETA=0.015  LEVEL=3)
Rd     d1    d2    0.78m TC=7m

Dbd     s2    d2    Dbt
.MODEL     Dbt    D(BV=38   M=0.3  CJO=6.93n  VJ=0.9V)
Dbody   s2   21    DBODY
.MODEL DBODY  D(IS=64.4p  N=1.1  RS=0.06u  EG=1.12  TT=3n)
Rdiode  d1  21    0.26m TC=10m

.MODEL   sw    NMOS(VTO=0  KP=10   LEVEL=1)
Maux      g2   c    a    a   sw
Maux2     b    d    g2    g2   sw
Eaux      c    a    d2    g2   1
Eaux2     d    g2   d2    g2   -1
Cox       b    d2   1.78n
.MODEL     DGD    D(M=0.6   CJO=1.78n   VJ=0.5)
Rpar      b    d2   1Meg
Dgd       a    d2   DGD
Rpar2     d2   a    10Meg
Cgs     g2    s2    7.38n

.ENDS  IPB80N03S4L_02_L0

******

.SUBCKT IPD70N03S4L_04_L0  drain  gate  source

Lg     gate  g1    3n
Ld     drain d1    1n
Ls     source s1   1.5n
Rs      s1    s2   891u

Rg     g1    g2     1.5
M1      d2    g2    s2    s2    DMOS    L=1u   W=1u
.MODEL DMOS NMOS ( KP= 259.2  VTO=2.62  THETA=0  VMAX=1.5e5  ETA=0.015  LEVEL=3)
Rd     d1    d2    2.19m TC=7m

Dbd     s2    d2    Dbt
.MODEL     Dbt    D(BV=38   M=0.3  CJO=2.64n  VJ=0.9V)
Dbody   s2   21    DBODY
.MODEL DBODY  D(IS=21.9p  N=1.1  RS=0.17u  EG=1.12  TT=3n)
Rdiode  d1  21    0.76m TC=10m

.MODEL   sw    NMOS(VTO=0  KP=10   LEVEL=1)
Maux      g2   c    a    a   sw
Maux2     b    d    g2    g2   sw
Eaux      c    a    d2    g2   1
Eaux2     d    g2   d2    g2   -1
Cox       b    d2   0.6n
.MODEL     DGD    D(M=0.6   CJO=0.6n   VJ=0.5)
Rpar      b    d2   1Meg
Dgd       a    d2   DGD
Rpar2     d2   a    10Meg
Cgs     g2    s2    2.51n

.ENDS  IPD70N03S4L_04_L0

******

.SUBCKT IPB80N03S4L_03_L0  drain  gate  source

Lg     gate  g1    4n
Ld     drain d1    1n
Ls     source s1   2n
Rs      s1    s2   941u

Rg     g1    g2     1.6
M1      d2    g2    s2    s2    DMOS    L=1u   W=1u
.MODEL DMOS NMOS ( KP= 401.9  VTO=2.62  THETA=0  VMAX=1.5e5  ETA=0.015  LEVEL=3)
Rd     d1    d2    1.43m TC=7m

Dbd     s2    d2    Dbt
.MODEL     Dbt    D(BV=38   M=0.3  CJO=3.88n  VJ=0.9V)
Dbody   s2   21    DBODY
.MODEL DBODY  D(IS=33.9p  N=1.1  RS=0.11u  EG=1.12  TT=3n)
Rdiode  d1  21    0.49m TC=10m

.MODEL   sw    NMOS(VTO=0  KP=10   LEVEL=1)
Maux      g2   c    a    a   sw
Maux2     b    d    g2    g2   sw
Eaux      c    a    d2    g2   1
Eaux2     d    g2   d2    g2   -1
Cox       b    d2   0.94n
.MODEL     DGD    D(M=0.6   CJO=0.94n   VJ=0.5)
Rpar      b    d2   1Meg
Dgd       a    d2   DGD
Rpar2     d2   a    10Meg
Cgs     g2    s2    3.89n

.ENDS  IPB80N03S4L_03_L0

******

.SUBCKT IPD90N03S4L_03_L0  drain  gate  source

Lg     gate  g1    3n
Ld     drain d1    1n
Ls     source s1   1.5n
Rs      s1    s2   723u

Rg     g1    g2     1.6
M1      d2    g2    s2    s2    DMOS    L=1u   W=1u
.MODEL DMOS NMOS ( KP= 401.9  VTO=2.62  THETA=0  VMAX=1.5e5  ETA=0.015  LEVEL=3)
Rd     d1    d2    1.43m TC=7m

Dbd     s2    d2    Dbt
.MODEL     Dbt    D(BV=38   M=0.3  CJO=3.88n  VJ=0.9V)
Dbody   s2   21    DBODY
.MODEL DBODY  D(IS=33.9p  N=1.1  RS=0.11u  EG=1.12  TT=3n)
Rdiode  d1  21    0.49m TC=10m

.MODEL   sw    NMOS(VTO=0  KP=10   LEVEL=1)
Maux      g2   c    a    a   sw
Maux2     b    d    g2    g2   sw
Eaux      c    a    d2    g2   1
Eaux2     d    g2   d2    g2   -1
Cox       b    d2   0.94n
.MODEL     DGD    D(M=0.6   CJO=0.94n   VJ=0.5)
Rpar      b    d2   1Meg
Dgd       a    d2   DGD
Rpar2     d2   a    10Meg
Cgs     g2    s2    3.89n

.ENDS  IPD90N03S4L_03_L0

******

.SUBCKT IPD40N03S4L_08_L0  drain  gate  source

Lg     gate  g1    3n
Ld     drain d1    1n
Ls     source s1   2n
Rs      s1    s2   1.53m

Rg     g1    g2     1
M1      d2    g2    s2    s2    DMOS    L=1u   W=1u
.MODEL DMOS NMOS ( KP= 113.4  VTO=2.62  THETA=0  VMAX=1.5e5  ETA=0.015  LEVEL=3)
Rd     d1    d2    4.93m TC=7m

Dbd     s2    d2    Dbt
.MODEL     Dbt    D(BV=38   M=0.3  CJO=1.31n  VJ=0.9V)
Dbody   s2   21    DBODY
.MODEL DBODY  D(IS=9.6p  N=1.1  RS=0.4u  EG=1.12  TT=3n)
Rdiode  d1  21    1.74m TC=10m

.MODEL   sw    NMOS(VTO=0  KP=10   LEVEL=1)
Maux      g2   c    a    a   sw
Maux2     b    d    g2    g2   sw
Eaux      c    a    d2    g2   1
Eaux2     d    g2   d2    g2   -1
Cox       b    d2   0.26n
.MODEL     DGD    D(M=0.6   CJO=0.26n   VJ=0.5)
Rpar      b    d2   1Meg
Dgd       a    d2   DGD
Rpar2     d2   a    10Meg
Cgs     g2    s2    1.1n

.ENDS  IPD40N03S4L_08_L0

******

.SUBCKT IPB20N03S4L_15_L0  drain  gate  source

Lg     gate  g1    4n
Ld     drain d1    1n
Ls     source s1   2.5n
Rs      s1    s2   3.53m

Rg     g1    g2     1.2
M1      d2    g2    s2    s2    DMOS    L=1u   W=1u
.MODEL DMOS NMOS ( KP= 77.9  VTO=2.62  THETA=0  VMAX=1.5e5  ETA=0.015  LEVEL=3)
Rd     d1    d2    7.16m TC=7m

Dbd     s2    d2    Dbt
.MODEL     Dbt    D(BV=38   M=0.3  CJO=0.96n  VJ=0.9V)
Dbody   s2   21    DBODY
.MODEL DBODY  D(IS=6.6p  N=1.1  RS=0.58u  EG=1.12  TT=3n)
Rdiode  d1  21    2.53m TC=10m

.MODEL   sw    NMOS(VTO=0  KP=10   LEVEL=1)
Maux      g2   c    a    a   sw
Maux2     b    d    g2    g2   sw
Eaux      c    a    d2    g2   1
Eaux2     d    g2   d2    g2   -1
Cox       b    d2   0.18n
.MODEL     DGD    D(M=0.6   CJO=0.18n   VJ=0.5)
Rpar      b    d2   1Meg
Dgd       a    d2   DGD
Rpar2     d2   a    10Meg
Cgs     g2    s2    0.75n

.ENDS  IPB20N03S4L_15_L0

******

.SUBCKT IPD30N03S4L_14_L0  drain  gate  source

Lg     gate  g1    3n
Ld     drain d1    1n
Ls     source s1   2n
Rs      s1    s2   2.35m

Rg     g1    g2     1.2
M1      d2    g2    s2    s2    DMOS    L=1u   W=1u
.MODEL DMOS NMOS ( KP= 77.9  VTO=2.62  THETA=0  VMAX=1.5e5  ETA=0.015  LEVEL=3)
Rd     d1    d2    7.16m TC=7m

Dbd     s2    d2    Dbt
.MODEL     Dbt    D(BV=38   M=0.3  CJO=0.96n  VJ=0.9V)
Dbody   s2   21    DBODY
.MODEL DBODY  D(IS=6.6p  N=1.1  RS=0.58u  EG=1.12  TT=3n)
Rdiode  d1  21    2.53m TC=10m

.MODEL   sw    NMOS(VTO=0  KP=10   LEVEL=1)
Maux      g2   c    a    a   sw
Maux2     b    d    g2    g2   sw
Eaux      c    a    d2    g2   1
Eaux2     d    g2   d2    g2   -1
Cox       b    d2   0.18n
.MODEL     DGD    D(M=0.6   CJO=0.18n   VJ=0.5)
Rpar      b    d2   1Meg
Dgd       a    d2   DGD
Rpar2     d2   a    10Meg
Cgs     g2    s2    0.75n

.ENDS  IPD30N03S4L_14_L0

******

.SUBCKT IPD50N03S4L_06_L0  drain  gate  source

Lg     gate  g1    3n
Ld     drain d1    1n
Ls     source s1   2n
Rs      s1    s2   1.11m

Rg     g1    g2     1.4
M1      d2    g2    s2    s2    DMOS    L=1u   W=1u
.MODEL DMOS NMOS ( KP= 183.3  VTO=2.62  THETA=0  VMAX=1.5e5  ETA=0.015  LEVEL=3)
Rd     d1    d2    3.07m TC=7m

Dbd     s2    d2    Dbt
.MODEL     Dbt    D(BV=38   M=0.3  CJO=1.96n  VJ=0.9V)
Dbody   s2   21    DBODY
.MODEL DBODY  D(IS=15.5p  N=1.1  RS=0.25u  EG=1.12  TT=3n)
Rdiode  d1  21    1.08m TC=10m

.MODEL   sw    NMOS(VTO=0  KP=10   LEVEL=1)
Maux      g2   c    a    a   sw
Maux2     b    d    g2    g2   sw
Eaux      c    a    d2    g2   1
Eaux2     d    g2   d2    g2   -1
Cox       b    d2   0.43n
.MODEL     DGD    D(M=0.6   CJO=0.43n   VJ=0.5)
Rpar      b    d2   1Meg
Dgd       a    d2   DGD
Rpar2     d2   a    10Meg
Cgs     g2    s2    1.77n

.ENDS  IPD50N03S4L_06_L0

**********

.SUBCKT IPD30N03S4L_09_L0  drain  gate  source

Lg     gate  g1    4n
Ld     drain d1    1n
Ls     source s1   1.8n
Rs      s1    s2   327u

Rg     g1    g2     1.5
M1      d2    g2    s2    s2    DMOS    L=1u   W=1u
.MODEL DMOS NMOS ( KP= 1781.1  VTO=2.62  THETA=0  VMAX=1.5e5  ETA=0.015  LEVEL=3)
Rd     d1    d2    0.33m TC=7m

Dbd     s2    d2    Dbt
.MODEL     Dbt    D(BV=38   M=0.3  CJO=15.24n  VJ=0.9V)
Dbody   s2   21    DBODY
.MODEL DBODY  D(IS=150.4p  N=1.1  RS=0.03u  EG=1.12  TT=3n)
Rdiode  d1  21    0.11m TC=10m

.MODEL   sw    NMOS(VTO=0  KP=10   LEVEL=1)
Maux      g2   c    a    a   sw
Maux2     b    d    g2    g2   sw
Eaux      c    a    d2    g2   1
Eaux2     d    g2   d2    g2   -1
Cox       b    d2   4.16n
.MODEL     DGD    D(M=0.6   CJO=4.16n   VJ=0.5)
Rpar      b    d2   1Meg
Dgd       a    d2   DGD
Rpar2     d2   a    10Meg
Cgs     g2    s2    17.22n

.ENDS  IPD30N03S4L_09_L0


********************************************************************************
* Special Level 0 Models
********************************************************************************

.SUBCKT IPD135N03L_L0  drain  gate  source

Lg     gate  g1    3n
Ld     drain d1    1n
Ls     source s1   2n
Rs      s1    s2   2.35m

Rg     g1    g2     1.2
M1      d2    g2    s2    s2    DMOS    L=1u   W=1u
.MODEL DMOS NMOS ( KP= 77.9  VTO=2.62  THETA=0  VMAX=1.5e5  ETA=0.015  LEVEL=3)
Rd     d1    d2    7.16m TC=7m

Dbd     s2    d2    Dbt
.MODEL     Dbt    D(BV=38   M=0.3  CJO=0.96n  VJ=0.9V)
Dbody   s2   21    DBODY
.MODEL DBODY  D(IS=6.6p  N=1.1  RS=0.58u  EG=1.12  TT=3n)
Rdiode  d1  21    2.53m TC=10m

.MODEL   sw    NMOS(VTO=0  KP=10   LEVEL=1)
Maux      g2   c    a    a   sw
Maux2     b    d    g2    g2   sw
Eaux      c    a    d2    g2   1
Eaux2     d    g2   d2    g2   -1
Cox       b    d2   0.18n
.MODEL     DGD    D(M=0.6   CJO=0.18n   VJ=0.5)
Rpar      b    d2   1Meg
Dgd       a    d2   DGD
Rpar2     d2   a    10Meg
Cgs     g2    s2    0.75n

.ENDS  IPD135N03L_L0

******
